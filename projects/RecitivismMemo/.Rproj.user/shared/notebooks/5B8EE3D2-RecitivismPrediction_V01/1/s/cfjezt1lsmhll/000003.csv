"0",""
"0","df <- "
"0","  recitData %>%"
"0","  filter(days_b_screening_arrest <= 30) %>%"
"0","  filter(days_b_screening_arrest >= -30) %>%"
"0","  filter(is_recid != -1) %>%"
"0","  filter(c_charge_degree != ""O"") %>%"
"0","  filter(priors_count != ""36"") %>%"
"0","  filter(priors_count != ""25"") %>%"
"0","  mutate(length_of_stay = as.numeric(as.Date(c_jail_out) - as.Date(c_jail_in)),"
"0","         priors_count = as.factor(priors_count),"
"0","         Recidivated = as.factor(ifelse(two_year_recid == 1,""Recidivate"",""notRecidivate"")),"
"0","         recidivatedNumeric = ifelse(Recidivated == ""Recidivate"", 1, 0),"
"0","         race2 = case_when(race == ""Caucasian""        ~ ""Caucasian"","
"0","                           race == ""African-American"" ~ ""African-American"", "
"0","                           TRUE                       ~ ""Other"")) %>%"
"0","  dplyr::select(sex,age,age_cat,race,race2,priors_count,two_year_recid,r_charge_desc,"
"0","         c_charge_desc,c_charge_degree,r_charge_degree,juv_other_count,"
"0","         length_of_stay,priors_count,Recidivated,recidivatedNumeric) %>%"
"0","  filter(priors_count != 38)"
"0",""
"0","group_by(df, c_charge_desc) %>%"
"0","  summarize(count = n()) %>%"
"0","  mutate(rate = count / sum(count)) %>%"
"0","  arrange(-rate) %>% head(9) %>%"
"0","  ggplot(aes(reorder(c_charge_desc, rate, FUN = max), "
"0","             rate, fill = c_charge_desc)) +"
"0","    geom_col() + coord_flip() +"
"0","    scale_fill_manual(values = palette_9_colors) +"
"0","    labs(x = ""Charge"", y = ""Rate"", title= ""Most frequent initial charges"") +"
"0","    plotTheme() + theme(legend.position = ""none"") "
"0",""
